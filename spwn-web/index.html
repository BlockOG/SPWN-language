<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>hello-wasm example</title>
    <style type="text/css">
      pre {
        margin: 0;
        font-family: monaco, "Courier New", Courier, monospace;
        line-height: 1.3;
        color: white;
        background: black;
      }

      textarea {
        background-color: black;
        color: white;
        font-family: monospace;
        font-size: larger;
      }
    </style>
  </head>
  <body>
    <pre id="console"></pre>
    <textarea id="code"></textarea>
    
    <script src="ansi_up.js" type="text/javascript"></script>
    <input type="button" value="run" id="run_button">
    <script type="module">
      import init, {run_spwn,init_panics} from "./pkg/spwn_web.js";
      init()
        .then(() => {
          init_panics();
          document.getElementById("run_button").addEventListener("click", run_code);
        });

      function run_code() {
        let code = document.getElementById("code").value;
          
        let txt = run_spwn(code)
        console.log(txt.length)
        let ansi_up = new AnsiUp;

        let html = ansi_up.ansi_to_html(txt);

        let cdiv = document.getElementById("console");

        cdiv.innerHTML = html;
      }
    </script>
    
  </body>
</html>